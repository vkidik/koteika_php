"use strict";
!(function () {
  var t = document.querySelector(".filter");
  if (t) {
    var e = t.querySelector(".filter__toggle"),
      o = t.querySelector(".filter__btn-close"),
      r = t.querySelector("#from"),
      n = t.querySelector("#up-to"),
      a = t.querySelector(".filter__hint"),
      i = t.querySelector(".filter__overlay"),
      l = document.querySelector("body");
    if (e && o && i && l) {
      var s = function () {
          t.classList.contains("filter--show") &&
            (t.classList.remove("filter--show"),
            l.classList.remove("noscroll"),
            l.classList.remove("blur-catalog"),
            o.removeEventListener("click", c),
            i.removeEventListener("click", d),
            document.removeEventListener("keydown", u));
        },
        c = function (e) {
          e.preventDefault(), s();
        },
        d = function (e) {
          e.target === i && (e.preventDefault(), s());
        },
        u = function (e) {
          27 === e.keyCode && s();
        },
        m = function () {
          parseInt(r.value, 10) <= parseInt(n.value, 10)
            ? (a.style.display = "none")
            : (a.style.display = "block");
        };
      e.addEventListener("click", function (e) {
        e.preventDefault(),
          t.classList.contains("filter--show") ||
            (t.classList.add("filter--show"),
            l.classList.add("noscroll"),
            l.classList.add("blur-catalog")),
          o.addEventListener("click", c),
          i.addEventListener("click", d),
          document.addEventListener("keydown", u);
      }),
        r.addEventListener("change", m),
        n.addEventListener("change", m);
    }
  }
})(),
  (function () {
    var t = document.querySelector(".header");
    if (t) {
      var o = t.querySelector(".header__toggle"),
        e = t.querySelectorAll(".nav__link"),
        r = document.querySelector("body");
      o &&
        r &&
        (t.classList.remove("header--nojs"),
        o.addEventListener("click", function () {
          t.classList.contains("header--closed")
            ? (t.classList.remove("header--closed"),
              t.classList.add("header--opened"),
              r.classList.add("noscroll"),
              o.setAttribute("aria-label", "Закрыть меню"))
            : (t.classList.add("header--closed"),
              t.classList.remove("header--opened"),
              r.classList.remove("noscroll"),
              o.setAttribute("aria-label", "Открыть меню"));
        }),
        e.length &&
          Array.from(e).forEach(function (e) {
            e.addEventListener("click", function () {
              t.classList.contains("header--opened") &&
                (t.classList.remove("header--opened"),
                r.classList.remove("noscroll"),
                t.classList.add("header--closed"),
                o.setAttribute("aria-label", "Открыть меню"));
            });
          }));
    }
  })(),
  (function () {
    var e = document.querySelector(".reviews__list-container"),
      t = document.querySelector(".reviews__list");
    e && t && (e.style.height = t.offsetHeight + "px");
  })(),
  (function () {
    function t(e) {
      e.preventDefault(),
        f.classList.add("overlay--show"),
        y.classList.remove("modal--hide"),
        y.classList.add("modal--show"),
        g && g.addEventListener("click", n),
        f.addEventListener("click", o),
        s.addEventListener("keydown", r),
        c.classList.add("noscroll"),
        l();
    }
    var o = function (e) {
        e.target === f && (a(), i(), l());
      },
      r = function (e) {
        27 === e.keyCode && (a(), i(), l());
      },
      n = function (e) {
        e.preventDefault(), a(), l();
      },
      e = function (e) {
        e.preventDefault(), i(), l();
      },
      a = function () {
        f.classList.remove("overlay--show"),
          y.classList.add("modal--hide"),
          y.classList.remove("modal--show"),
          c.classList.remove("noscroll");
      },
      i = function () {
        f.classList.remove("overlay--show"),
          L.classList.add("modal--hide"),
          L.classList.remove("modal--show"),
          c.classList.remove("noscroll");
      },
      l = function () {
        d.classList.toggle("blur"),
          u.classList.toggle("blur"),
          m.classList.toggle("blur");
      },
      s = document.documentElement,
      c = document.querySelector("body"),
      d = document.querySelector("main"),
      u = document.querySelector("header"),
      m = document.querySelector("footer"),
      v = document.querySelectorAll(".book-button"),
      f = document.querySelector(".overlay"),
      y = document.querySelector(".modal--book"),
      L = document.querySelector(".modal--accept"),
      g = document.querySelector("#form-close-x"),
      h = document.querySelector("#accept-close"),
      p = document.querySelector("#accept-close-x"),
      _ = document.querySelector("#name"),
      S = document.querySelector("#pet-name"),
      w = document.querySelector("#email"),
      q = document.querySelector("#arrival"),
      b = document.querySelector("#departure"),
      k = document.querySelector('input[type="tel"]'),
      E = document.querySelector("#book"),
      I = {
        name: "",
        petName: "",
        tel: "",
        email: "",
        arrival: "",
        departure: "",
      },
      A = !0;
    try {
      I = localStorage;
    } catch (e) {
      A = !1;
    }
    if (k) IMask(k, { mask: "+{7} (000) 000-00-00" });
    E &&
      E.addEventListener("submit", function () {
        _ &&
          S &&
          k &&
          w &&
          q &&
          b &&
          A &&
          (localStorage.setItem("name", _.value),
          localStorage.setItem("petName", S.value),
          localStorage.setItem("tel", k.value),
          localStorage.setItem("email", w.value),
          localStorage.setItem("arrival", q.value),
          localStorage.setItem("departure", b.value)),
          a(),
          f.classList.add("overlay--show"),
          L.classList.remove("modal--hide"),
          L.classList.add("modal--show"),
          h.addEventListener("click", e),
          p.addEventListener("click", e);
      }),
      0 < v.length &&
        f &&
        y &&
        v.forEach(function (e) {
          e.addEventListener("click", t);
        }),
      _ &&
        S &&
        k &&
        w &&
        q &&
        b &&
        (void 0 === I.name ? (_.value = "") : (_.value = I.name),
        void 0 === I.petName ? (S.value = "") : (S.value = I.petName),
        void 0 === I.tel ? (k.value = "") : (k.value = I.tel),
        void 0 === I.email ? (w.value = "") : (w.value = I.email),
        void 0 === I.arrival ? (q.value = "") : (q.value = I.arrival),
        void 0 === I.departure ? (b.value = "") : (b.value = I.departure));
  })(),
  (function () {
    var e = document.querySelectorAll(".offer__hint");
    if (e.length && document.querySelector(".offer__hint")) {
      var t = function () {
        window.matchMedia("(min-width: 1024px)").matches
          ? Array.from(e).forEach(function (e) {
              !(function (e) {
                var t = e.parentNode,
                  o = e.previousElementSibling;
                if (t && o) {
                  var r = o.offsetLeft;
                  t.offsetWidth / 2 <= r
                    ? e.classList.contains("offer__hint--two-line") &&
                      e.classList.remove("offer__hint--two-line")
                    : e.classList.contains("offer__hint--two-line") ||
                      e.classList.add("offer__hint--two-line");
                }
              })(e);
            })
          : Array.from(e).forEach(function (e) {
              (e.style.right = ""), (e.style.left = ""), (e.style.top = "");
            });
      };
      t(), window.addEventListener("resize", t);
    }
  })(),
  (function () {
    var e = document.querySelector(".reviews__list-container"),
      t = document.querySelector(".reviews__list");
    if (document.querySelector(".reviews__list")) {
      new Swiper(".reviews__list-container", {
        init: !0,
        loop: !0,
        speed: 400,
        spaceBetween: 20,
        slidesPerView: 1,
        navigation: {
          nextEl: ".slider-controls__review-button-next",
          prevEl: ".slider-controls__review-button-prev",
        },
        a11y: !0,
        keyboardControl: !0,
        grabCursor: !0,
        pagination: { el: ".dots--review", type: "bullets" },
        breakpoints: {
          768: { slidesPerView: 2, spaceBetween: 30 },
          1024: { slidesPerView: 3, spaceBetween: 30 },
        },
      });
      e && t && (e.style.height = t.offsetHeight + "px");
    }
  })(),
  (function () {
    if (document.querySelector(".rooms__list"))
      new Swiper(".rooms__slider-container", {
        init: !0,
        loop: !0,
        speed: 400,
        spaceBetween: 128,
        slidesPerView: 1,
        navigation: {
          nextEl: ".slider-controls__button--next",
          prevEl: ".slider-controls__button--prev",
        },
        a11y: !0,
        keyboardControl: !0,
        grabCursor: !0,
        pagination: { el: ".dots--room", type: "bullets" },
      });
  })(),
  (function () {
    var e = document.querySelectorAll(".nav__link");
    e.length &&
      Array.from(e).forEach(function (e) {
        !(function (e) {
          var t = e.href,
            o = t.indexOf("#");
          if (-1 !== o)
            var r = t.slice(o),
              n = document.querySelector(r);
          n &&
            e.addEventListener("click", function (e) {
              e.preventDefault(),
                console.log(n),
                n.scrollIntoView({ block: "start", behavior: "smooth" });
            });
        })(e);
      });
  })(),
  (function () {
    var r = document.querySelector(".sorting");
    if (r) {
      var e = r.querySelector(".sorting__toggle"),
        t = r.querySelectorAll(".sorting__link"),
        n = r.querySelector(".sorting__item--current");
      if (e && n && t.length) {
        var a = function () {
            r.classList.add("sorting--show"),
              (e.ariaLabel = "Cкрыть варианты сортировки");
          },
          i = function () {
            r.classList.remove("sorting--show"),
              (e.ariaLabel = "Показать варианты сортировки");
          };
        e.addEventListener("click", function () {
          (r.classList.contains("sorting--show") ? i : a)();
        }),
          Array.from(t).forEach(function (o) {
            o.addEventListener("click", function (e) {
              /*e.preventDefault()*/
              var t = o.parentNode;
              t !== n
                ? (t.classList.add("sorting__item--current"),
                  n.classList.remove("sorting__item--current"),
                  (n = t),
                  i())
                : (r.classList.contains("sorting--show") ? i : a)();
            });
          });
      }
    }
  })(),
  (function () {
    var t,
      o = [59.938631, 30.323055],
      r = [59.938631, 30.323055],
      n = document.querySelector("#map");
    ymaps.ready(function () {
      var e = new ymaps.Map(n, { center: o, zoom: 16 });
      e.behaviors.disable("scrollZoom"),
        (t = new ymaps.Placemark(
          r,
          {},
          {
            iconLayout: "default#image",
            iconImageHref: "img/icon-pin.svg",
            iconImageSize: [62, 88],
            iconImageOffset: [-30, -60],
          }
        )),
        e.geoObjects.add(t),
        t &&
          (window.matchMedia("(min-width: 768px)").matches
            ? t.options.set({
                iconLayout: "default#image",
                iconImageHref: "img/icon-pin.svg",
                iconImageSize: [62, 88],
                iconImageOffset: [-30, -60],
              })
            : t.options.set({
                iconLayout: "default#image",
                iconImageHref: "img/icon-pin.svg",
                iconImageSize: [52, 76],
                iconImageOffset: [-30, -50],
              }));
    });
  })();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpbHRlci5qcyIsImhlYWRlci5qcyIsIm1haW4tcGFnZS5qcyIsIm1vZGFscy5qcyIsIm9mZmVyLmpzIiwicmV2aWV3LXNsaWRlci5qcyIsInJvb21zLXNsaWRlci5qcyIsInNjcm9sbC10by1hbmNob3IuanMiLCJzb3J0aW5nLmpzIiwieWFuZGV4LW1hcC5qcyJdLCJuYW1lcyI6WyJmaWx0ZXJXcmFwcGVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwib3BlbkJ1dHRvbiIsImNsb3NlQnV0dG9uIiwiaW5wdXRGcm9tRUxlbWVudCIsImlucHV0VXBUb0VsZW1lbnQiLCJmaWx0ZXJIaW50Iiwib3ZlcmxheSIsImJvZHkiLCJjbG9zZUZpbHRlciIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm9uQnV0dG9uQ2xpY2siLCJvbk92ZXJsYXlDbGljayIsIm9uUG9wdXBFc2NQcmVzcyIsImV2dCIsInByZXZlbnREZWZhdWx0IiwidGFyZ2V0Iiwia2V5Q29kZSIsIm9uRmlsdGVyV3JhcHBlcklucHV0IiwicGFyc2VJbnQiLCJ2YWx1ZSIsInN0eWxlIiwiZGlzcGxheSIsImFkZEV2ZW50TGlzdGVuZXIiLCJhZGQiLCJwYWdlSGVhZGVyIiwiaGVhZGVyVG9nZ2xlIiwiaGVhZGVyTGluayIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzZXRBdHRyaWJ1dGUiLCJsZW5ndGgiLCJBcnJheSIsImZyb20iLCJmb3JFYWNoIiwibGluayIsImxpc3RDb250YWluZXJFbGVtZW50IiwibGlzdEVsZW1lbnQiLCJoZWlnaHQiLCJvZmZzZXRIZWlnaHQiLCJvbkJvb2tCdXR0b25FbGVtZW50Q2xpY2siLCJvdmVybGF5RWxlbWVudCIsIm1vZGFsRm9ybUVsZW1lbnQiLCJtb2RhbEZvcm1DbG9zZUVsZW1lbnQiLCJvbk1vZGFsRm9ybUNsb3NlRWxlbWVudENsaWNrIiwib25PdmVybGF5RWxlbWVudENsaWNrIiwiZG9jdW1lbnRFbGVtZW50Iiwib25Eb2N1bWVudEVsZW1lbnRDbGljayIsImJvZHlFbGVtZW50IiwidG9nZ2xlQmx1ciIsIm1vZGFsRm9ybUNsb3NlIiwibW9kYWxBY2NlcHRDbG9zZSIsIm9uTW9kYWxBY2NlcHRDbG9zZUVsZW1lbnRDbGljayIsIm1vZGFsQWNjZXB0RWxlbWVudCIsIm1haW5FbGVtZW50IiwidG9nZ2xlIiwiaGVhZGVyRWxlbWVudCIsImZvb3RlckVsZW1lbnQiLCJib29rQnV0dG9uRWxlbWVudHMiLCJtb2RhbEFjY2VwdENsb3NlRWxlbWVudCIsIm1vZGFsQWNjZXB0Q2xvc2VYRWxlbWVudCIsImlucHV0TmFtZUVsZW1lbnQiLCJpbnB1dFBldE5hbWVFbGVtZW50IiwiaW5wdXRFbWFpbEVsZW1lbnQiLCJpbnB1dEFycml2YWxFbGVtZW50IiwiaW5wdXREZXBhcnR1cmVFbGVtZW50IiwiaW5wdXRUZWxFbGVtZW50IiwiYm9va0Zvcm1FbGVtZW50Iiwic3RvcmFnZSIsIm5hbWUiLCJwZXROYW1lIiwidGVsIiwiZW1haWwiLCJhcnJpdmFsIiwiZGVwYXJ0dXJlIiwiaXNTdG9yYWdlU3VwcG9ydCIsImxvY2FsU3RvcmFnZSIsImVyciIsIklNYXNrIiwibWFzayIsInNldEl0ZW0iLCJlbGVtIiwiaGludExpc3QiLCJtb3ZlQWxsSGludHMiLCJ3aW5kb3ciLCJtYXRjaE1lZGlhIiwibWF0Y2hlcyIsImhpbnQiLCJoaW50UGFyZW50IiwicGFyZW50Tm9kZSIsImljb24iLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwic2hpZnRJY29uIiwib2Zmc2V0TGVmdCIsIm9mZnNldFdpZHRoIiwibW92ZUhpbnQiLCJyaWdodCIsImxlZnQiLCJ0b3AiLCJTd2lwZXIiLCJpbml0IiwibG9vcCIsInNwZWVkIiwic3BhY2VCZXR3ZWVuIiwic2xpZGVzUGVyVmlldyIsIm5hdmlnYXRpb24iLCJuZXh0RWwiLCJwcmV2RWwiLCJhMTF5Iiwia2V5Ym9hcmRDb250cm9sIiwiZ3JhYkN1cnNvciIsInBhZ2luYXRpb24iLCJlbCIsInR5cGUiLCJicmVha3BvaW50cyIsIjc2OCIsIjEwMjQiLCJuYXZMaW5rIiwibGlua0hyZWYiLCJocmVmIiwicG9zSWQiLCJpbmRleE9mIiwiaWQiLCJzbGljZSIsImFuY2hvciIsImNvbnNvbGUiLCJsb2ciLCJzY3JvbGxJbnRvVmlldyIsImJsb2NrIiwiYmVoYXZpb3IiLCJzY3JvbGxUb0FuY2hvciIsInNvcnRpbmdXcmFwcGVyIiwic29ydGluZ1RvZ2dsZSIsInNvcnRpbmdMaW5rTGlzdCIsImN1cnJlbnRJdGVtIiwib3BlblNvcnRpbmciLCJhcmlhTGFiZWwiLCJjbG9zZVNvcnRpbmciLCJpdGVtIiwicGFyZW50IiwibXlQbGFjZW1hcmsiLCJDT09SRElOQVRFX0NFTlRFUiIsIkNPT1JESU5BVEVfTUFSS0VSIiwibWFwIiwieW1hcHMiLCJyZWFkeSIsIm15TWFwIiwiTWFwIiwiY2VudGVyIiwiem9vbSIsImJlaGF2aW9ycyIsImRpc2FibGUiLCJQbGFjZW1hcmsiLCJpY29uTGF5b3V0IiwiaWNvbkltYWdlSHJlZiIsImljb25JbWFnZVNpemUiLCJpY29uSW1hZ2VPZmZzZXQiLCJnZW9PYmplY3RzIiwib3B0aW9ucyIsInNldCJdLCJtYXBwaW5ncyI6IkFBQUEsY0FFQSxXQUNBLElBQ0FBLEVBQUFDLFNBQUFDLGNBQUEsV0FFQSxHQUFBRixFQUFBLENBSUEsSUFBQUcsRUFBQUgsRUFBQUUsY0FBQSxtQkFDQUUsRUFBQUosRUFBQUUsY0FBQSxzQkFDQUcsRUFBQUwsRUFBQUUsY0FBQSxTQUNBSSxFQUFBTixFQUFBRSxjQUFBLFVBQ0FLLEVBQUFQLEVBQUFFLGNBQUEsaUJBQ0FNLEVBQUFSLEVBQUFFLGNBQUEsb0JBQ0FPLEVBQUFSLFNBQUFDLGNBQUEsUUFFQSxHQUFBQyxHQUFBQyxHQUFBSSxHQUFBQyxFQUFBLENBSUEsSUFRQUMsRUFBQSxXQUNBVixFQUFBVyxVQUFBQyxTQUFBLGtCQUNBWixFQUFBVyxVQUFBRSxPQUFBLGdCQUNBSixFQUFBRSxVQUFBRSxPQUFBLFlBQ0FKLEVBQUFFLFVBQUFFLE9B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b3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBFU0NfS0VZQ09ERSA9IDI3O1xuICB2YXIgZmlsdGVyV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5maWx0ZXInKTtcblxuICBpZiAoIWZpbHRlcldyYXBwZXIpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgb3BlbkJ1dHRvbiA9IGZpbHRlcldyYXBwZXIucXVlcnlTZWxlY3RvcignLmZpbHRlcl9fdG9nZ2xlJyk7XG4gIHZhciBjbG9zZUJ1dHRvbiA9IGZpbHRlcldyYXBwZXIucXVlcnlTZWxlY3RvcignLmZpbHRlcl9fYnRuLWNsb3NlJyk7XG4gIHZhciBpbnB1dEZyb21FTGVtZW50ID0gZmlsdGVyV3JhcHBlci5xdWVyeVNlbGVjdG9yKCcjZnJvbScpO1xuICB2YXIgaW5wdXRVcFRvRWxlbWVudCA9IGZpbHRlcldyYXBwZXIucXVlcnlTZWxlY3RvcignI3VwLXRvJyk7XG4gIHZhciBmaWx0ZXJIaW50ID0gZmlsdGVyV3JhcHBlci5xdWVyeVNlbGVjdG9yKCcuZmlsdGVyX19oaW50Jyk7XG4gIHZhciBvdmVybGF5ID0gZmlsdGVyV3JhcHBlci5xdWVyeVNlbGVjdG9yKCcuZmlsdGVyX19vdmVybGF5Jyk7XG4gIHZhciBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xuXG4gIGlmICghb3BlbkJ1dHRvbiB8fCAhY2xvc2VCdXR0b24gfHwgIW92ZXJsYXkgfHwgIWJvZHkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgb3BlbkZpbHRlciA9IGZ1bmN0aW9uIG9wZW5GaWx0ZXIoKSB7XG4gICAgaWYgKCFmaWx0ZXJXcmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnZmlsdGVyLS1zaG93JykpIHtcbiAgICAgIGZpbHRlcldyYXBwZXIuY2xhc3NMaXN0LmFkZCgnZmlsdGVyLS1zaG93Jyk7XG4gICAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ25vc2Nyb2xsJyk7XG4gICAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ2JsdXItY2F0YWxvZycpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgY2xvc2VGaWx0ZXIgPSBmdW5jdGlvbiBjbG9zZUZpbHRlcigpIHtcbiAgICBpZiAoZmlsdGVyV3JhcHBlci5jbGFzc0xpc3QuY29udGFpbnMoJ2ZpbHRlci0tc2hvdycpKSB7XG4gICAgICBmaWx0ZXJXcmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2ZpbHRlci0tc2hvdycpO1xuICAgICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdub3Njcm9sbCcpO1xuICAgICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdibHVyLWNhdGFsb2cnKTtcbiAgICAgIGNsb3NlQnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25CdXR0b25DbGljayk7XG4gICAgICBvdmVybGF5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25PdmVybGF5Q2xpY2spO1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIG9uUG9wdXBFc2NQcmVzcyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBpc0VzY0V2ZW50ID0gZnVuY3Rpb24gaXNFc2NFdmVudChldnQpIHtcbiAgICByZXR1cm4gZXZ0LmtleUNvZGUgPT09IEVTQ19LRVlDT0RFO1xuICB9O1xuXG4gIHZhciBvbkJ1dHRvbkNsaWNrID0gZnVuY3Rpb24gb25CdXR0b25DbGljayhldnQpIHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBjbG9zZUZpbHRlcigpO1xuICB9O1xuXG4gIHZhciBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uIG9uT3ZlcmxheUNsaWNrKGV2dCkge1xuICAgIGlmIChldnQudGFyZ2V0ID09PSBvdmVybGF5KSB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGNsb3NlRmlsdGVyKCk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBvblBvcHVwRXNjUHJlc3MgPSBmdW5jdGlvbiBvblBvcHVwRXNjUHJlc3MoZXZ0KSB7XG4gICAgaWYgKGlzRXNjRXZlbnQoZXZ0KSkge1xuICAgICAgY2xvc2VGaWx0ZXIoKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGlzSW5wdXRDb3JyZWN0ID0gZnVuY3Rpb24gaXNJbnB1dENvcnJlY3QoKSB7XG4gICAgaWYgKHBhcnNlSW50KGlucHV0RnJvbUVMZW1lbnQudmFsdWUsIDEwKSA8PSBwYXJzZUludChpbnB1dFVwVG9FbGVtZW50LnZhbHVlLCAxMCkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xuXG4gIHZhciBvbkZpbHRlcldyYXBwZXJJbnB1dCA9IGZ1bmN0aW9uIG9uRmlsdGVyV3JhcHBlcklucHV0KCkge1xuICAgIGlmIChpc0lucHV0Q29ycmVjdCgpKSB7XG4gICAgICBmaWx0ZXJIaW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZpbHRlckhpbnQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgfVxuICB9O1xuXG4gIG9wZW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgb3BlbkZpbHRlcigpO1xuICAgIGNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25CdXR0b25DbGljayk7XG4gICAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT3ZlcmxheUNsaWNrKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgb25Qb3B1cEVzY1ByZXNzKTtcbiAgfSk7XG4gIGlucHV0RnJvbUVMZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25GaWx0ZXJXcmFwcGVySW5wdXQpO1xuICBpbnB1dFVwVG9FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmlsdGVyV3JhcHBlcklucHV0KTtcbn0pKCk7IiwiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgcGFnZUhlYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXInKTtcblxuICBpZiAoIXBhZ2VIZWFkZXIpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgaGVhZGVyVG9nZ2xlID0gcGFnZUhlYWRlci5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX190b2dnbGUnKTtcbiAgdmFyIGhlYWRlckxpbmsgPSBwYWdlSGVhZGVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5uYXZfX2xpbmsnKTtcbiAgdmFyIGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG5cbiAgaWYgKCFoZWFkZXJUb2dnbGUgfHwgIWJvZHkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBwYWdlSGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2hlYWRlci0tbm9qcycpO1xuICBoZWFkZXJUb2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHBhZ2VIZWFkZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdoZWFkZXItLWNsb3NlZCcpKSB7XG4gICAgICBwYWdlSGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2hlYWRlci0tY2xvc2VkJyk7XG4gICAgICBwYWdlSGVhZGVyLmNsYXNzTGlzdC5hZGQoJ2hlYWRlci0tb3BlbmVkJyk7XG4gICAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ25vc2Nyb2xsJyk7XG4gICAgICBoZWFkZXJUb2dnbGUuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ9CX0LDQutGA0YvRgtGMINC80LXQvdGOJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBhZ2VIZWFkZXIuY2xhc3NMaXN0LmFkZCgnaGVhZGVyLS1jbG9zZWQnKTtcbiAgICAgIHBhZ2VIZWFkZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGVhZGVyLS1vcGVuZWQnKTtcbiAgICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnbm9zY3JvbGwnKTtcbiAgICAgIGhlYWRlclRvZ2dsZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAn0J7RgtC60YDRi9GC0Ywg0LzQtdC90Y4nKTtcbiAgICB9XG4gIH0pO1xuXG4gIGlmICghaGVhZGVyTGluay5sZW5ndGgpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBBcnJheS5mcm9tKGhlYWRlckxpbmspLmZvckVhY2goZnVuY3Rpb24gKGxpbmspIHtcbiAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHBhZ2VIZWFkZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdoZWFkZXItLW9wZW5lZCcpKSB7XG4gICAgICAgIHBhZ2VIZWFkZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGVhZGVyLS1vcGVuZWQnKTtcbiAgICAgICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdub3Njcm9sbCcpO1xuICAgICAgICBwYWdlSGVhZGVyLmNsYXNzTGlzdC5hZGQoJ2hlYWRlci0tY2xvc2VkJyk7XG4gICAgICAgIGhlYWRlclRvZ2dsZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAn0J7RgtC60YDRi9GC0Ywg0LzQtdC90Y4nKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59KSgpOyIsIid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGhlaWdodENoYW5nZSA9IGZ1bmN0aW9uIGhlaWdodENoYW5nZSgpIHtcbiAgICBsaXN0Q29udGFpbmVyRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBsaXN0RWxlbWVudC5vZmZzZXRIZWlnaHQgKyAncHgnO1xuICB9O1xuXG4gIHZhciBsaXN0Q29udGFpbmVyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXZpZXdzX19saXN0LWNvbnRhaW5lcicpO1xuICB2YXIgbGlzdEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmV2aWV3c19fbGlzdCcpO1xuXG4gIGlmIChsaXN0Q29udGFpbmVyRWxlbWVudCAmJiBsaXN0RWxlbWVudCkge1xuICAgIGhlaWdodENoYW5nZSgpO1xuICB9XG59KSgpOyIsIid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIEVTQ19LRVlDT0RFID0gMjc7XG5cbiAgdmFyIG9uQm9va0J1dHRvbkVsZW1lbnRDbGljayA9IGZ1bmN0aW9uIG9uQm9va0J1dHRvbkVsZW1lbnRDbGljayhldnQpIHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdvdmVybGF5LS1zaG93Jyk7XG4gICAgbW9kYWxGb3JtRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdtb2RhbC0taGlkZScpO1xuICAgIG1vZGFsRm9ybUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnbW9kYWwtLXNob3cnKTtcblxuICAgIGlmIChtb2RhbEZvcm1DbG9zZUVsZW1lbnQpIHtcbiAgICAgIG1vZGFsRm9ybUNsb3NlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uTW9kYWxGb3JtQ2xvc2VFbGVtZW50Q2xpY2spO1xuICAgIH1cblxuICAgIG92ZXJsYXlFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25PdmVybGF5RWxlbWVudENsaWNrKTtcbiAgICBkb2N1bWVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIG9uRG9jdW1lbnRFbGVtZW50Q2xpY2spO1xuICAgIGJvZHlFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ25vc2Nyb2xsJyk7XG4gICAgdG9nZ2xlQmx1cigpO1xuICB9O1xuXG4gIHZhciBmaWxsRm9ybUlucHV0ID0gZnVuY3Rpb24gZmlsbEZvcm1JbnB1dCgpIHtcbiAgICBpZiAoaW5wdXROYW1lRWxlbWVudCAmJiBpbnB1dFBldE5hbWVFbGVtZW50ICYmIGlucHV0VGVsRWxlbWVudCAmJiBpbnB1dEVtYWlsRWxlbWVudCAmJiBpbnB1dEFycml2YWxFbGVtZW50ICYmIGlucHV0RGVwYXJ0dXJlRWxlbWVudCkge1xuICAgICAgaWYgKHR5cGVvZiBzdG9yYWdlLm5hbWUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGlucHV0TmFtZUVsZW1lbnQudmFsdWUgPSAnJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlucHV0TmFtZUVsZW1lbnQudmFsdWUgPSBzdG9yYWdlLm5hbWU7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2Ygc3RvcmFnZS5wZXROYW1lID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICBpbnB1dFBldE5hbWVFbGVtZW50LnZhbHVlID0gJyc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbnB1dFBldE5hbWVFbGVtZW50LnZhbHVlID0gc3RvcmFnZS5wZXROYW1lO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIHN0b3JhZ2UudGVsID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICBpbnB1dFRlbEVsZW1lbnQudmFsdWUgPSAnJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlucHV0VGVsRWxlbWVudC52YWx1ZSA9IHN0b3JhZ2UudGVsO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIHN0b3JhZ2UuZW1haWwgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGlucHV0RW1haWxFbGVtZW50LnZhbHVlID0gJyc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbnB1dEVtYWlsRWxlbWVudC52YWx1ZSA9IHN0b3JhZ2UuZW1haWw7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2Ygc3RvcmFnZS5hcnJpdmFsID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICBpbnB1dEFycml2YWxFbGVtZW50LnZhbHVlID0gJyc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbnB1dEFycml2YWxFbGVtZW50LnZhbHVlID0gc3RvcmFnZS5hcnJpdmFsO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIHN0b3JhZ2UuZGVwYXJ0dXJlID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICBpbnB1dERlcGFydHVyZUVsZW1lbnQudmFsdWUgPSAnJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlucHV0RGVwYXJ0dXJlRWxlbWVudC52YWx1ZSA9IHN0b3JhZ2UuZGVwYXJ0dXJlO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICB2YXIgb25Cb29rRm9ybUVsZW1lbnRTdWJtaXQgPSBmdW5jdGlvbiBvbkJvb2tGb3JtRWxlbWVudFN1Ym1pdCgpIHtcbiAgICBpZiAoaW5wdXROYW1lRWxlbWVudCAmJiBpbnB1dFBldE5hbWVFbGVtZW50ICYmIGlucHV0VGVsRWxlbWVudCAmJiBpbnB1dEVtYWlsRWxlbWVudCAmJiBpbnB1dEFycml2YWxFbGVtZW50ICYmIGlucHV0RGVwYXJ0dXJlRWxlbWVudCkge1xuICAgICAgaWYgKGlzU3RvcmFnZVN1cHBvcnQpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ25hbWUnLCBpbnB1dE5hbWVFbGVtZW50LnZhbHVlKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3BldE5hbWUnLCBpbnB1dFBldE5hbWVFbGVtZW50LnZhbHVlKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3RlbCcsIGlucHV0VGVsRWxlbWVudC52YWx1ZSk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdlbWFpbCcsIGlucHV0RW1haWxFbGVtZW50LnZhbHVlKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2Fycml2YWwnLCBpbnB1dEFycml2YWxFbGVtZW50LnZhbHVlKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2RlcGFydHVyZScsIGlucHV0RGVwYXJ0dXJlRWxlbWVudC52YWx1ZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbW9kYWxGb3JtQ2xvc2UoKTtcbiAgICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdvdmVybGF5LS1zaG93Jyk7XG4gICAgbW9kYWxBY2NlcHRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsLS1oaWRlJyk7XG4gICAgbW9kYWxBY2NlcHRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ21vZGFsLS1zaG93Jyk7XG4gICAgbW9kYWxBY2NlcHRDbG9zZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk1vZGFsQWNjZXB0Q2xvc2VFbGVtZW50Q2xpY2spO1xuICAgIG1vZGFsQWNjZXB0Q2xvc2VYRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uTW9kYWxBY2NlcHRDbG9zZUVsZW1lbnRDbGljayk7XG4gIH07XG5cbiAgdmFyIG9uT3ZlcmxheUVsZW1lbnRDbGljayA9IGZ1bmN0aW9uIG9uT3ZlcmxheUVsZW1lbnRDbGljayhldnQpIHtcbiAgICBpZiAoZXZ0LnRhcmdldCA9PT0gb3ZlcmxheUVsZW1lbnQpIHtcbiAgICAgIG1vZGFsRm9ybUNsb3NlKCk7XG4gICAgICBtb2RhbEFjY2VwdENsb3NlKCk7XG4gICAgICB0b2dnbGVCbHVyKCk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBvbkRvY3VtZW50RWxlbWVudENsaWNrID0gZnVuY3Rpb24gb25Eb2N1bWVudEVsZW1lbnRDbGljayhldnQpIHtcbiAgICBpZiAoZXZ0LmtleUNvZGUgPT09IEVTQ19LRVlDT0RFKSB7XG4gICAgICBtb2RhbEZvcm1DbG9zZSgpO1xuICAgICAgbW9kYWxBY2NlcHRDbG9zZSgpO1xuICAgICAgdG9nZ2xlQmx1cigpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgb25Nb2RhbEZvcm1DbG9zZUVsZW1lbnRDbGljayA9IGZ1bmN0aW9uIG9uTW9kYWxGb3JtQ2xvc2VFbGVtZW50Q2xpY2soZXZ0KSB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgbW9kYWxGb3JtQ2xvc2UoKTtcbiAgICB0b2dnbGVCbHVyKCk7XG4gIH07XG5cbiAgdmFyIG9uTW9kYWxBY2NlcHRDbG9zZUVsZW1lbnRDbGljayA9IGZ1bmN0aW9uIG9uTW9kYWxBY2NlcHRDbG9zZUVsZW1lbnRDbGljayhldnQpIHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBtb2RhbEFjY2VwdENsb3NlKCk7XG4gICAgdG9nZ2xlQmx1cigpO1xuICB9O1xuXG4gIHZhciBtb2RhbEZvcm1DbG9zZSA9IGZ1bmN0aW9uIG1vZGFsRm9ybUNsb3NlKCkge1xuICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ292ZXJsYXktLXNob3cnKTtcbiAgICBtb2RhbEZvcm1FbGVtZW50LmNsYXNzTGlzdC5hZGQoJ21vZGFsLS1oaWRlJyk7XG4gICAgbW9kYWxGb3JtRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdtb2RhbC0tc2hvdycpO1xuICAgIGJvZHlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ25vc2Nyb2xsJyk7XG4gIH07XG5cbiAgdmFyIG1vZGFsQWNjZXB0Q2xvc2UgPSBmdW5jdGlvbiBtb2RhbEFjY2VwdENsb3NlKCkge1xuICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ292ZXJsYXktLXNob3cnKTtcbiAgICBtb2RhbEFjY2VwdEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnbW9kYWwtLWhpZGUnKTtcbiAgICBtb2RhbEFjY2VwdEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWwtLXNob3cnKTtcbiAgICBib2R5RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdub3Njcm9sbCcpO1xuICB9O1xuXG4gIHZhciB0b2dnbGVCbHVyID0gZnVuY3Rpb24gdG9nZ2xlQmx1cigpIHtcbiAgICBtYWluRWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdibHVyJyk7XG4gICAgaGVhZGVyRWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdibHVyJyk7XG4gICAgZm9vdGVyRWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdibHVyJyk7XG4gIH07XG5cbiAgdmFyIGRvY3VtZW50RWxlbWVudCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcbiAgdmFyIGJvZHlFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xuICB2YXIgbWFpbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtYWluJyk7XG4gIHZhciBoZWFkZXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZGVyJyk7XG4gIHZhciBmb290ZXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9vdGVyJyk7XG4gIHZhciBib29rQnV0dG9uRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYm9vay1idXR0b24nKTtcbiAgdmFyIG92ZXJsYXlFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm92ZXJsYXknKTtcbiAgdmFyIG1vZGFsRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtLWJvb2snKTtcbiAgdmFyIG1vZGFsQWNjZXB0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC0tYWNjZXB0Jyk7XG4gIHZhciBtb2RhbEZvcm1DbG9zZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZm9ybS1jbG9zZS14Jyk7XG4gIHZhciBtb2RhbEFjY2VwdENsb3NlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhY2NlcHQtY2xvc2UnKTtcbiAgdmFyIG1vZGFsQWNjZXB0Q2xvc2VYRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhY2NlcHQtY2xvc2UteCcpO1xuICB2YXIgaW5wdXROYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuYW1lJyk7XG4gIHZhciBpbnB1dFBldE5hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3BldC1uYW1lJyk7XG4gIHZhciBpbnB1dEVtYWlsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNlbWFpbCcpO1xuICB2YXIgaW5wdXRBcnJpdmFsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhcnJpdmFsJyk7XG4gIHZhciBpbnB1dERlcGFydHVyZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZGVwYXJ0dXJlJyk7XG4gIHZhciBpbnB1dFRlbEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFt0eXBlPVwidGVsXCJdJyk7XG4gIHZhciBtYXNrT3B0aW9ucyA9IHtcbiAgICBtYXNrOiAnK3s3fSAoMDAwKSAwMDAtMDAtMDAnXG4gIH07XG4gIHZhciBib29rRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYm9vaycpO1xuICB2YXIgc3RvcmFnZSA9IHtcbiAgICBuYW1lOiAnJyxcbiAgICBwZXROYW1lOiAnJyxcbiAgICB0ZWw6ICcnLFxuICAgIGVtYWlsOiAnJyxcbiAgICBhcnJpdmFsOiAnJyxcbiAgICBkZXBhcnR1cmU6ICcnXG4gIH07XG4gIHZhciBpc1N0b3JhZ2VTdXBwb3J0ID0gdHJ1ZTtcblxuICB0cnkge1xuICAgIHN0b3JhZ2UgPSBsb2NhbFN0b3JhZ2U7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGlzU3RvcmFnZVN1cHBvcnQgPSBmYWxzZTtcbiAgfVxuXG4gIGlmIChpbnB1dFRlbEVsZW1lbnQpIHtcbiAgICB2YXIgbWFzayA9IElNYXNrKGlucHV0VGVsRWxlbWVudCwgbWFza09wdGlvbnMpO1xuICB9XG5cbiAgaWYgKGJvb2tGb3JtRWxlbWVudCkge1xuICAgIGJvb2tGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBvbkJvb2tGb3JtRWxlbWVudFN1Ym1pdCk7XG4gIH1cblxuICBpZiAoYm9va0J1dHRvbkVsZW1lbnRzLmxlbmd0aCA+IDAgJiYgb3ZlcmxheUVsZW1lbnQgJiYgbW9kYWxGb3JtRWxlbWVudCkge1xuICAgIGJvb2tCdXR0b25FbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtKSB7XG4gICAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25Cb29rQnV0dG9uRWxlbWVudENsaWNrKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZpbGxGb3JtSW5wdXQoKTtcbn0pKCk7IiwiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgaGludExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcub2ZmZXJfX2hpbnQnKTtcblxuICBpZiAoIWhpbnRMaXN0Lmxlbmd0aCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBmaXJzdEhpbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcub2ZmZXJfX2hpbnQnKTtcblxuICBpZiAoIWZpcnN0SGludCkge1xuICAgIHJldHVybjtcbiAgfSAvLyDQstGL0YfQuNGB0LvRj9C10YIg0LrQvtC+0YDQuNC90LDRgtGLINCy0YHQv9C70YvQstCw0Y7RidC10Lkg0L/QvtC00YHQutCw0LfQutC4XG5cblxuICB2YXIgbW92ZUhpbnQgPSBmdW5jdGlvbiBtb3ZlSGludChoaW50KSB7XG4gICAgdmFyIGhpbnRQYXJlbnQgPSBoaW50LnBhcmVudE5vZGU7IC8vINGA0L7QtNC40YLQtdC70YzRgdC60LjQuSDQsdC70L7QuiDQvtGC0L3QvtGB0LjRgtC10LvRjNC90L4g0LrQvtGC0L7RgNC+0LPQviDQuNC00LXRgiDQv9C+0LfQuNGG0LjQvtC90LjRgNC+0LLQsNC90LjQtVxuXG4gICAgdmFyIGljb24gPSBoaW50LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7IC8vINC40LrQvtC90LrQsCwg0Log0LrQvtGC0L7RgNC+0Lkg0L7RgtC90L7RgdC40YLRgdGPINC/0L7QtNGB0LrQsNC30LrQsFxuXG4gICAgaWYgKCFoaW50UGFyZW50IHx8ICFpY29uKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHNoaWZ0SWNvbiA9IGljb24ub2Zmc2V0TGVmdDsgLy8g0L/QvtC70L7QttC10L3QuNC1INC40LrQvtC90LrQuCDQvtGC0L3QvtGB0LjRgtC10LvRjNC90L4g0YDQvtC00LjRgtC10LvRjNGB0LrQvtCz0L4g0LHQu9C+0LrQsFxuXG4gICAgdmFyIHBhcmVudFdpZHRoID0gaGludFBhcmVudC5vZmZzZXRXaWR0aDsgLy8g0YjQuNGA0LjQvdCwINGA0L7QtNC40YLQtdC70YzRgdC60L7Qs9C+INCx0LvQvtC60LBcbiAgICAvLyDRgNCw0YHRgdGH0LXRgiDQv9C+0LfQuNGG0LjQuCDQv9C+0LTRgdC60LDQt9C60Lgg0LIg0LfQsNCy0LjRgdC40LzQvtGB0YLQuCDQvtGCINGC0L7Qs9C+LCDQsiDQutCw0LrQvtC5INC/0L7Qu9C+0LLQuNC90LUg0LHQu9C+0LrQsCDQvdCw0YXQvtC00LjRgtGB0Y8g0LjQutC+0L3QutCwXG5cbiAgICBpZiAoc2hpZnRJY29uID49IHBhcmVudFdpZHRoIC8gMikge1xuICAgICAgaWYgKGhpbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdvZmZlcl9faGludC0tdHdvLWxpbmUnKSkge1xuICAgICAgICBoaW50LmNsYXNzTGlzdC5yZW1vdmUoJ29mZmVyX19oaW50LS10d28tbGluZScpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIWhpbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdvZmZlcl9faGludC0tdHdvLWxpbmUnKSkge1xuICAgICAgICBoaW50LmNsYXNzTGlzdC5hZGQoJ29mZmVyX19oaW50LS10d28tbGluZScpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICB2YXIgbW92ZUFsbEhpbnRzID0gZnVuY3Rpb24gbW92ZUFsbEhpbnRzKCkge1xuICAgIGlmICh3aW5kb3cubWF0Y2hNZWRpYSgnKG1pbi13aWR0aDogMTAyNHB4KScpLm1hdGNoZXMpIHtcbiAgICAgIEFycmF5LmZyb20oaGludExpc3QpLmZvckVhY2goZnVuY3Rpb24gKGhpbnQpIHtcbiAgICAgICAgbW92ZUhpbnQoaGludCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgQXJyYXkuZnJvbShoaW50TGlzdCkuZm9yRWFjaChmdW5jdGlvbiAoaGludCkge1xuICAgICAgICBoaW50LnN0eWxlLnJpZ2h0ID0gJyc7XG4gICAgICAgIGhpbnQuc3R5bGUubGVmdCA9ICcnO1xuICAgICAgICBoaW50LnN0eWxlLnRvcCA9ICcnO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIG1vdmVBbGxIaW50cygpO1xuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgbW92ZUFsbEhpbnRzKTtcbn0pKCk7IiwiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgaGVpZ2h0Q2hhbmdlID0gZnVuY3Rpb24gaGVpZ2h0Q2hhbmdlKCkge1xuICAgIGxpc3RDb250YWluZXJFbGVtZW50LnN0eWxlLmhlaWdodCA9IGxpc3RFbGVtZW50Lm9mZnNldEhlaWdodCArICdweCc7XG4gIH07XG5cbiAgdmFyIGxpc3RDb250YWluZXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJldmlld3NfX2xpc3QtY29udGFpbmVyJyk7XG4gIHZhciBsaXN0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXZpZXdzX19saXN0Jyk7XG4gIHZhciByZXZpZXdzU2xpZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJldmlld3NfX2xpc3QnKTtcblxuICBpZiAoIXJldmlld3NTbGlkZXIpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgcmV2aWV3c1N3aXBlciA9IG5ldyBTd2lwZXIoJy5yZXZpZXdzX19saXN0LWNvbnRhaW5lcicsIHtcbiAgICBpbml0OiB0cnVlLFxuICAgIGxvb3A6IHRydWUsXG4gICAgc3BlZWQ6IDQwMCxcbiAgICBzcGFjZUJldHdlZW46IDIwLFxuICAgIHNsaWRlc1BlclZpZXc6IDEsXG4gICAgbmF2aWdhdGlvbjoge1xuICAgICAgbmV4dEVsOiAnLnNsaWRlci1jb250cm9sc19fcmV2aWV3LWJ1dHRvbi1uZXh0JyxcbiAgICAgIHByZXZFbDogJy5zbGlkZXItY29udHJvbHNfX3Jldmlldy1idXR0b24tcHJldidcbiAgICB9LFxuICAgIGExMXk6IHRydWUsXG4gICAga2V5Ym9hcmRDb250cm9sOiB0cnVlLFxuICAgIGdyYWJDdXJzb3I6IHRydWUsXG4gICAgcGFnaW5hdGlvbjoge1xuICAgICAgZWw6ICcuZG90cy0tcmV2aWV3JyxcbiAgICAgIHR5cGU6ICdidWxsZXRzJ1xuICAgIH0sXG4gICAgYnJlYWtwb2ludHM6IHtcbiAgICAgIDc2ODoge1xuICAgICAgICBzbGlkZXNQZXJWaWV3OiAyLFxuICAgICAgICBzcGFjZUJldHdlZW46IDMwXG4gICAgICB9LFxuICAgICAgMTAyNDoge1xuICAgICAgICBzbGlkZXNQZXJWaWV3OiAzLFxuICAgICAgICBzcGFjZUJldHdlZW46IDMwXG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICBpZiAobGlzdENvbnRhaW5lckVsZW1lbnQgJiYgbGlzdEVsZW1lbnQpIHtcbiAgICBoZWlnaHRDaGFuZ2UoKTtcbiAgfVxufSkoKTsiLCIndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciByb29tc1NsaWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yb29tc19fbGlzdCcpO1xuXG4gIGlmICghcm9vbXNTbGlkZXIpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgcm9vbXNTd2lwZXIgPSBuZXcgU3dpcGVyKCcucm9vbXNfX3NsaWRlci1jb250YWluZXInLCB7XG4gICAgaW5pdDogdHJ1ZSxcbiAgICBsb29wOiB0cnVlLFxuICAgIHNwZWVkOiA0MDAsXG4gICAgc3BhY2VCZXR3ZWVuOiAxMjgsXG4gICAgc2xpZGVzUGVyVmlldzogMSxcbiAgICBuYXZpZ2F0aW9uOiB7XG4gICAgICBuZXh0RWw6ICcuc2xpZGVyLWNvbnRyb2xzX19idXR0b24tLW5leHQnLFxuICAgICAgcHJldkVsOiAnLnNsaWRlci1jb250cm9sc19fYnV0dG9uLS1wcmV2J1xuICAgIH0sXG4gICAgYTExeTogdHJ1ZSxcbiAgICBrZXlib2FyZENvbnRyb2w6IHRydWUsXG4gICAgZ3JhYkN1cnNvcjogdHJ1ZSxcbiAgICBwYWdpbmF0aW9uOiB7XG4gICAgICBlbDogJy5kb3RzLS1yb29tJyxcbiAgICAgIHR5cGU6ICdidWxsZXRzJ1xuICAgIH1cbiAgfSk7XG59KSgpOyIsIid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIG5hdkxpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubmF2X19saW5rJyk7XG5cbiAgdmFyIHNjcm9sbFRvQW5jaG9yID0gZnVuY3Rpb24gc2Nyb2xsVG9BbmNob3IobGluaykge1xuICAgIHZhciBsaW5rSHJlZiA9IGxpbmsuaHJlZjtcbiAgICB2YXIgcG9zSWQgPSBsaW5rSHJlZi5pbmRleE9mKCcjJyk7XG5cbiAgICBpZiAocG9zSWQgIT09IC0xKSB7XG4gICAgICB2YXIgaWQgPSBsaW5rSHJlZi5zbGljZShwb3NJZCk7XG4gICAgICB2YXIgYW5jaG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihpZCk7XG4gICAgfVxuXG4gICAgaWYgKGFuY2hvcikge1xuICAgICAgbGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGFuY2hvcik7XG4gICAgICAgIGFuY2hvci5zY3JvbGxJbnRvVmlldyh7XG4gICAgICAgICAgYmxvY2s6ICdzdGFydCcsXG4gICAgICAgICAgYmVoYXZpb3I6ICdzbW9vdGgnXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIGlmIChuYXZMaW5rLmxlbmd0aCkge1xuICAgIEFycmF5LmZyb20obmF2TGluaykuZm9yRWFjaChmdW5jdGlvbiAobGluaykge1xuICAgICAgc2Nyb2xsVG9BbmNob3IobGluayk7XG4gICAgfSk7XG4gIH1cbn0pKCk7IiwiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgc29ydGluZ1dyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc29ydGluZycpO1xuXG4gIGlmICghc29ydGluZ1dyYXBwZXIpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgc29ydGluZ1RvZ2dsZSA9IHNvcnRpbmdXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy5zb3J0aW5nX190b2dnbGUnKTtcbiAgdmFyIHNvcnRpbmdMaW5rTGlzdCA9IHNvcnRpbmdXcmFwcGVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zb3J0aW5nX19saW5rJyk7XG4gIHZhciBjdXJyZW50SXRlbSA9IHNvcnRpbmdXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy5zb3J0aW5nX19pdGVtLS1jdXJyZW50Jyk7XG5cbiAgaWYgKCFzb3J0aW5nVG9nZ2xlIHx8ICFjdXJyZW50SXRlbSB8fCAhc29ydGluZ0xpbmtMaXN0Lmxlbmd0aCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBvcGVuU29ydGluZyA9IGZ1bmN0aW9uIG9wZW5Tb3J0aW5nKCkge1xuICAgIHNvcnRpbmdXcmFwcGVyLmNsYXNzTGlzdC5hZGQoJ3NvcnRpbmctLXNob3cnKTtcbiAgICBzb3J0aW5nVG9nZ2xlLmFyaWFMYWJlbCA9ICdD0LrRgNGL0YLRjCDQstCw0YDQuNCw0L3RgtGLINGB0L7RgNGC0LjRgNC+0LLQutC4JztcbiAgfTtcblxuICB2YXIgY2xvc2VTb3J0aW5nID0gZnVuY3Rpb24gY2xvc2VTb3J0aW5nKCkge1xuICAgIHNvcnRpbmdXcmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3NvcnRpbmctLXNob3cnKTtcbiAgICBzb3J0aW5nVG9nZ2xlLmFyaWFMYWJlbCA9ICfQn9C+0LrQsNC30LDRgtGMINCy0LDRgNC40LDQvdGC0Ysg0YHQvtGA0YLQuNGA0L7QstC60LgnO1xuICB9O1xuXG4gIHNvcnRpbmdUb2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFzb3J0aW5nV3JhcHBlci5jbGFzc0xpc3QuY29udGFpbnMoJ3NvcnRpbmctLXNob3cnKSkge1xuICAgICAgb3BlblNvcnRpbmcoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2xvc2VTb3J0aW5nKCk7XG4gICAgfVxuICB9KTtcbiAgQXJyYXkuZnJvbShzb3J0aW5nTGlua0xpc3QpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB2YXIgcGFyZW50ID0gaXRlbS5wYXJlbnROb2RlO1xuXG4gICAgICBpZiAocGFyZW50ICE9PSBjdXJyZW50SXRlbSkge1xuICAgICAgICBwYXJlbnQuY2xhc3NMaXN0LmFkZCgnc29ydGluZ19faXRlbS0tY3VycmVudCcpO1xuICAgICAgICBjdXJyZW50SXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdzb3J0aW5nX19pdGVtLS1jdXJyZW50Jyk7XG4gICAgICAgIGN1cnJlbnRJdGVtID0gcGFyZW50O1xuICAgICAgICBjbG9zZVNvcnRpbmcoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghc29ydGluZ1dyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzb3J0aW5nLS1zaG93JykpIHtcbiAgICAgICAgICBvcGVuU29ydGluZygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNsb3NlU29ydGluZygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufSkoKTsiLCIndXNlIHN0cmljdCc7IC8vINGB0LrRgNC40L/RgiDQuNC90LjRhtC40LDQu9C40LfQsNGG0LjQuCDRj9C90LTQtdC60YEt0LrQsNGA0YLRi1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgQ09PUkRJTkFURV9DRU5URVIgPSBbNTkuOTM4NjMxLCAzMC4zMjMwNTVdO1xuICB2YXIgQ09PUkRJTkFURV9NQVJLRVIgPSBbNTkuOTM4NjMxLCAzMC4zMjMwNTVdO1xuICB2YXIgWk9PTSA9IDE2OyAvLyDQo9GA0L7QstC10L3RjCDQvNCw0YHRiNGC0LDQsdC40YDQvtCy0LDQvdC40Y8uINCU0L7Qv9GD0YHRgtC40LzRi9C1INC30L3QsNGH0LXQvdC40Y86INC+0YIgMCAo0LLQtdGB0Ywg0LzQuNGAKSDQtNC+IDE5XG5cbiAgdmFyIG1hcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtYXAnKTtcbiAgdmFyIG15UGxhY2VtYXJrO1xuXG4gIHZhciByZXNpemVQaW4gPSBmdW5jdGlvbiByZXNpemVQaW4oKSB7XG4gICAgaWYgKG15UGxhY2VtYXJrKSB7XG4gICAgICBpZiAod2luZG93Lm1hdGNoTWVkaWEoJyhtaW4td2lkdGg6IDc2OHB4KScpLm1hdGNoZXMpIHtcbiAgICAgICAgbXlQbGFjZW1hcmsub3B0aW9ucy5zZXQoe1xuICAgICAgICAgIGljb25MYXlvdXQ6ICdkZWZhdWx0I2ltYWdlJyxcbiAgICAgICAgICBpY29uSW1hZ2VIcmVmOiAnaW1nL2ljb24tcGluLnN2ZycsXG4gICAgICAgICAgaWNvbkltYWdlU2l6ZTogWzYyLCA4OF0sXG4gICAgICAgICAgaWNvbkltYWdlT2Zmc2V0OiBbLTMwLCAtNjBdXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbXlQbGFjZW1hcmsub3B0aW9ucy5zZXQoe1xuICAgICAgICAgIGljb25MYXlvdXQ6ICdkZWZhdWx0I2ltYWdlJyxcbiAgICAgICAgICBpY29uSW1hZ2VIcmVmOiAnaW1nL2ljb24tcGluLnN2ZycsXG4gICAgICAgICAgaWNvbkltYWdlU2l6ZTogWzUyLCA3Nl0sXG4gICAgICAgICAgaWNvbkltYWdlT2Zmc2V0OiBbLTMwLCAtNTBdXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgLy8g0KHQvtC30LTQsNC90LjQtSDQutCw0YDRgtGLLlxuICAgIHZhciBteU1hcCA9IG5ldyB5bWFwcy5NYXAobWFwLCB7XG4gICAgICAvLyDQmtC+0L7RgNC00LjQvdCw0YLRiyDRhtC10L3RgtGA0LAg0LrQsNGA0YLRiy5cbiAgICAgIGNlbnRlcjogQ09PUkRJTkFURV9DRU5URVIsXG4gICAgICB6b29tOiBaT09NXG4gICAgfSk7XG4gICAgbXlNYXAuYmVoYXZpb3JzLmRpc2FibGUoJ3Njcm9sbFpvb20nKTsgLy8g0LTQvtCx0LDQstC70LXQvdC40LUg0LzQtdGC0LrQuCDQvdCwINC60LDRgNGC0YNcblxuICAgIG15UGxhY2VtYXJrID0gbmV3IHltYXBzLlBsYWNlbWFyayhDT09SRElOQVRFX01BUktFUiwge30sIHtcbiAgICAgIGljb25MYXlvdXQ6ICdkZWZhdWx0I2ltYWdlJyxcbiAgICAgIGljb25JbWFnZUhyZWY6ICdpbWcvaWNvbi1waW4uc3ZnJyxcbiAgICAgIC8vINC60LDRgNGC0LjQvdC60LAg0LjQutC+0L3QutC4XG4gICAgICBpY29uSW1hZ2VTaXplOiBbNjIsIDg4XSxcbiAgICAgIC8vINGA0LDQt9C80LXRgNGLINC60LDRgNGC0LjQvdC60LhcbiAgICAgIGljb25JbWFnZU9mZnNldDogWy0zMCwgLTYwXSAvLyDRgdC80LXRidC10L3QuNC1INC60LDRgNGC0LjQvdC60LhcblxuICAgIH0pOyAvLyDQlNC+0LHQsNCy0LvQtdC90LjQtSDQvNC10YLQutC4INC90LAg0LrQsNGA0YLRg1xuXG4gICAgbXlNYXAuZ2VvT2JqZWN0cy5hZGQobXlQbGFjZW1hcmspO1xuICAgIHJlc2l6ZVBpbigpO1xuICB9O1xuXG4gIHltYXBzLnJlYWR5KGluaXQpOyAvL3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemVQaW4pO1xufSkoKTsiXX0=
